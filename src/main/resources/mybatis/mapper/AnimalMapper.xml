<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.practice.setoka.mapper.AnimalMapper">

  <!-- resultMap : Animal 클래스 필드와 DB 컬럼 매핑 -->
  <resultMap id="animalResultMap" type="com.practice.setoka.dao.Animal">
    <id property="num" column="num" />
    <result property="userNum" column="userNum" />
    <result property="animalName" column="animalName" />
    <result property="species" column="species" />
    <result property="age" column="age" />
    <result property="status" column="status" />
    <result property="gender" column="gender" />
    <result property="togetherDate" column="togetherDate" />
  </resultMap>

  <!-- 유저 번호로 해당 유저의 애견 목록 조회 -->
  <select id="selectByUserNum" resultMap="animalResultMap" parameterType="int">
    SELECT num, userNum, animalName, species, age, status, gender, togetherDate
    FROM animal
    WHERE userNum = #{userNum}
    ORDER BY num
  </select>

  <!-- 고유번호로 단일 애견 조회 -->
  <select id="selectByNum" resultMap="animalResultMap" parameterType="int">
    SELECT num, userNum, animalName, species, age, status, gender, togetherDate
    FROM animal
    WHERE num = #{num}
  </select>

  <!-- 새 애견 등록 -->
  <insert id="insertAnimal" parameterType="com.practice.setoka.dto.AnimalDto">
    INSERT INTO animal (userNum, animalName, species, age, status, gender, togetherDate, profilePath)
    VALUES (#{userNum}, #{animalName}, #{species}, #{age}, #{status}, #{gender}, #{togetherDate}, #{profilePath})
  </insert>

  <!-- 애견 정보 수정 -->
  <update id="updateAnimal">
    UPDATE animal
    SET userNum = #{animalDto.userNum},
        animalName = #{animalDto.animalName},
        species = #{animalDto.species},
        age = #{animalDto.age},
        status = #{animalDto.status},
        gender = #{animalDto.gender},
        togetherDate = #{animalDto.togetherDate},
        profilePath = #{animalDto.profilePath}
    WHERE num = #{num}
  </update>

  <!-- 애견 삭제 -->
  <delete id="deleteAnimal" parameterType="int">
    DELETE FROM animal WHERE num = #{num}
  </delete>

</mapper>
