<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<title>출석 체크</title>
	<style>
		table {
			width: 350px;
			margin: 20px auto;
			border-collapse: collapse;
		}

		th,
		td {
			border: 1px solid #ccc;
			width: 14.28%;
			height: 80px;
			vertical-align: top;
			padding: 5px;
			cursor: pointer;
		}

		th {
			background: #eee;
		}



		.nav-buttons {
			text-align: center;
			margin: 10px 0;
		}

		button {
			margin: 0 10px;
			padding: 5px 15px;
		}

		.blank {
			background: #f9f9f9;
			cursor: default;
		}
	</style>
</head>

<body>

	<div class="nav-buttons">
		<form th:action="@{/attendcheck}" method="get" style="display:inline;">
			<input type="hidden" name="year" th:value="${month == 1} ? ${year - 1} : ${year}" />
			<input type="hidden" name="month" th:value="${(month == 1) ? 12 : (month - 1)}" />
			<button type="submit">◀ 이전달</button>
		</form>

		<span id="yearMonth" th:attr="data-year=${year}, data-month=${month}"
			th:text="${year} + '년 ' + ${month} + '월'"></span>

		<form th:action="@{/attendcheck}" method="get" style="display:inline;">
			<input type="hidden" name="year" th:value="${month == 12} ? ${year + 1} : ${year}" />
			<input type="hidden" name="month" th:value="${(month == 12) ? 1 : (month + 1)}" />
			<button type="submit">다음달 ▶</button>
		</form>
	</div>

	<table id="calendar">
		<thead>
			<tr>
				<th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th>
			</tr>
		</thead>

		<tbody>
			<tr th:each="weekRow : ${#numbers.sequence(0, weekCount - 1)}">
				<td th:each="dayIdx : ${#numbers.sequence(0,6)}"
				    th:classappend="${((weekRow * 7) + dayIdx + 1 - startBlank <= 0 
				                   or (weekRow * 7) + dayIdx + 1 - startBlank > lengthOfMonth) ? 'blank' : ''}"
				    th:attr="data-date=${((weekRow * 7) + dayIdx + 1 - startBlank > 0) and ((weekRow * 7) + dayIdx + 1 - startBlank <= lengthOfMonth) ? 
				                      year + '-' + (month < 10 ? '0' + month : month) + '-' + 
				                      (((weekRow * 7) + dayIdx + 1 - startBlank < 10) ? '0' + ((weekRow * 7) + dayIdx + 1 - startBlank) : ((weekRow * 7) + dayIdx + 1 - startBlank)) : ''}">
				  
				  <span th:if="${(weekRow * 7) + dayIdx + 1 - startBlank > 0 
				               and (weekRow * 7) + dayIdx + 1 - startBlank <= lengthOfMonth}"
				        th:text="${(weekRow * 7) + dayIdx + 1 - startBlank}">
				  </span>

				</td>
			</tr>
		</tbody>
	</table>

</body>

</html>