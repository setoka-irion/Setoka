<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<title>ì…ì–‘ ê²Œì‹œíŒ</title>
	<link rel="stylesheet" th:href="@{/CSS/header.css}">
	<style>
		/* ====== ì»¨í…Œì´ë„ˆ ====== */
		.container-board {
			width: 80%;
			margin: 20px auto;
			position: relative;
			background-color: #fff;
			padding: 15px 20px;
			box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
			border-radius: 6px;
		}

		.board-header h1 {
			margin: 0;
			font-size: 24px; /* í•„ìš” ì‹œ í¬ê¸° ì¡°ì ˆ */
			margin-top: 20px; 
			margin-left: 170px;
		}

		.board-header p {
			margin: 4px 0 0; /* ìœ„ ê°„ê²©ë§Œ ì•„ì£¼ ì¡°ê¸ˆ ì¤Œ */
			font-size: 14px;
			color: #555;
			margin-left: 170px;
		}
		
		/* ====== ê²€ìƒ‰ë°•ìŠ¤ ====== */
		.search-box {
		margin-bottom: 20px;
		display: flex;
		justify-content: flex-end;
		width: 90%;
		}

		.search-input:focus,
		.search-select:focus {
		outline: none;
		border-color: #8b5e3c;
		}

		.search-input,
		.search-select {
		padding: 8px 10px;
		font-size: 14px;
		border: 1px solid #ccc;
		border-radius: 4px;
		margin-right: 10px;
		transition: border-color 0.3s ease;
		}

		.search-input:focus,
		.search-select:focus {
		outline: none;
		border-color: #8b5e3c;
		}
		
		
		/* ====== ë²„íŠ¼ ====== */
		.btn-primary {
			display: inline-block;
			padding: 8px 16px;
			background-color: #8b5e3c;
			color: white;
			border-radius: 4px;
			font-weight: 600;
			text-decoration: none;
			transition: background-color 0.3s ease;
			box-shadow: 0 2px 5px rgba(139, 94, 60, 0.4);
		}

		.btn-primary:hover {
			background-color: #8b5e3c;
			box-shadow: 0 4px 8px rgba(139, 94, 60, 0.6);
		}

		.btn-search {
			padding: 8px 18px;
			font-size: 14px;
			cursor: pointer;
			background-color: #8b5e3c;
			color: white;
			border: none;
			border-radius: 4px;
			font-weight: 600;
			box-shadow: 0 2px 5px rgba(139, 94, 60, 0.4);
			transition: background-color 0.3s ease;
		}

		.btn-search:hover {
			background-color: #8b5e3c;
			box-shadow: 0 4px 8px rgba(139, 94, 60, 0.6);
		}

		.position-top-right {
			position: absolute;
			top: 15px;
			right: 20px;
		}

		/* ====== ì¸ê¸°ê¸€ ì˜ì—­ ====== */
		.popular-section {
			display: flex;
			flex-wrap: wrap;
			justify-content: center; /* ê°€ìš´ë° ì •ë ¬*/
			gap: 20px;
			margin-top: 20px;
		}

		.card-popular {
			width: 300px;
			border: 1px solid #ddd;
			border-radius: 10px;
			overflow: hidden;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
			padding: 10px;
			background: #fff;
		}
		/* ì¸ë„¤ì¼ ì¡°ì •*/
		.thumb-image {
			width: 300px;
			height: 240px;
			object-fit: cover;
			border-radius: 10px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
		}

		.card-popular strong {
			font-size: 18px;
			display: block;
			margin-bottom: 5px;
		}

		.card-popular span {
			display: block;
			font-size: 14px;
			color: #555;
			margin-bottom: 3px;
		}

		

		/* ====== í…Œì´ë¸” ====== */
		.table-posts {
			border-collapse: collapse;
			width: 100%;
			margin-top: 50px;
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			font-size: 14px;
		}

		.table-posts th {
			background-color: #f8f9fb;
			color: #333;
			font-weight: 700;
			padding: 12px 10px;
			border-bottom: 2px solid #ddd;
		}

		.table-posts td {
			border: 1px solid #ddd;
			padding: 10px 8px;
			text-align: center;
			color: #555;
		}
		
		/* ë³¸ë¬¸ í˜•ì‹ ì§€ì •*/
		.card-list-view {
			display: flex;
			flex-wrap: wrap;
			gap: 20px;
			margin-top: 20px;
			justify-content: center;
		}

		
		/* ====== ë§í¬ ====== */
		/* ì¼ë°˜ ë³¸ë¬¸ ë§í¬ */
		.link-default {
			color: #8b5e3c;
			text-decoration: none;
			transition: color 0.3s ease;
		}

		.link-default:hover {
			text-decoration: underline;
			color: #8b5e3c;
		}

		/* ì¹´ë“œ ì œëª©, ê°•ì¡° í…ìŠ¤íŠ¸ ë§í¬ */
		.link-title {
			font-weight: bold;
			font-size: 18px;
			color: #8b5e3c;
			text-decoration: none;
			transition: color 0.3s ease;
		}

		.link-title:hover {
			text-decoration: underline;
			color: #8b5e3c;
		}

		/* ====== í˜ì´ì§€ë„¤ì´ì…˜ ====== */
		.pagination {
			text-align: center;
			margin-top: 30px;
		}

		.pagination-list {
			list-style: none;
			padding: 0;
			margin: 0 auto;
			display: inline-flex;
			gap: 8px;
		}

		.pagination-item {
			border: 1px solid #ccc;
			border-radius: 4px;
			padding: 6px 12px;
		}

		.pagination-item.active {
			background-color: #8b5e3c;
			color: white;
			font-weight: 700;
			border-color: #8b5e3c;
		}

		.pagination-link {
			color: inherit;
			text-decoration: none;
			display: block;
		}

		/* ìˆ¨ê¹€ í´ë˜ìŠ¤ */
		.hidden {
			display: none !important;
		}

		/* ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ í•­ëª© ìŠ¤íƒ€ì¼ */
		.card-list-item {
			border: 1px solid #ddd;
			padding: 15px;
			margin-bottom: 15px;
			border-radius: 8px;
			background: #fff;
			box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
		}

		.card-list-item img.thumb-image {
			width: 180px;
			height: 130px;
			object-fit: cover;
			border-radius: 10px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
			display: block;
			margin-bottom: 10px;
		}
	
		/* ë³´ê¸° ë°©ì‹ì „í™˜*/
		.toggle-switch {
		  display: inline-flex;
		  border: 1px solid #8b5e3c;
		  border-radius: 8px;
		  overflow: hidden;
		  cursor: pointer;
		  user-select: none;
		  font-weight: 600;
		  font-size: 16px;
		  color: #8b5e3c;
		  background: white;
		}

		.toggle-switch input[type="radio"] {
		  display: none; /* ê¸°ë³¸ ë¼ë””ì˜¤ ìˆ¨ê¸°ê¸° */
		}

		.toggle-switch label {
		  padding: 6px 15px;
		  transition: background-color 0.3s, color 0.3s;
		  user-select: none;
		  text-align: center;
		  flex: 1; /* ê· ë“± í­ */
		}

		.toggle-switch label:hover {
		  background-color: #f0e8db;
		}

		.toggle-switch input[type="radio"]:checked + label {
		  background-color: #8b5e3c;
		  color: white;
		}
	</style>
</head>

<body>
	<!-- í—¤ë” -->
	<div th:replace="~{header :: siteHeader}"></div>

	<!-- ìœ—ë‹¨ ì•„ì´ì½˜ -->
	<div class="board-header">
	<h1>ì…ì–‘ ê²Œì‹œíŒ</h1>
	<p>ì´ ê²Œì‹œê¸€ ìˆ˜: <span th:text="${totalCount}">0</span></p>
	</div>
	
	<!-- ê²€ìƒ‰ -->
	<form th:action="@{/Adopt}" method="get" class="search-box">
		<select name="field" class="search-select" th:value="${field}">
			<option value="title" th:selected="${field == 'title'}">ì œëª©</option>
			<option value="content" th:selected="${field == 'content'}">ë‚´ìš©</option>
			<option value="nickname" th:selected="${field == 'nickname'}">ì‘ì„±ì</option>
			<option value="" th:selected="${field == ''}">í†µí•© ê²€ìƒ‰</option>
		</select>
		<input type="text" name="keyword" class="search-input" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" th:value="${keyword}" />
		<button type="submit" class="btn-search">ê²€ìƒ‰</button>
	</form>

	<!-- ì»¨í…Œì´ë„ˆ -->
	<div class="container-board">
		<!-- ìƒˆ ê¸€ ë“±ë¡ ë²„íŠ¼-->
		<p class="position-top-right">
			<a th:href="@{/AdoptRegist}" class="btn-primary">ìƒˆ ê¸€ ë“±ë¡í•˜ê¸°</a>
		</p>

		<div class="view-select toggle-switch">
		  <input type="radio" id="viewCard" name="viewType" value="card" checked />
		  <label for="viewCard">ì¹´ë“œí˜•</label>
		  <input type="radio" id="viewList" name="viewType" value="list" />
		  <label for="viewList">ë¦¬ìŠ¤íŠ¸í˜•</label>
		</div>

		<!-- ì¸ê¸°ê¸€ (ê¸°ì¡´) -->
		<h3>ğŸ”¥ ì¸ê¸°ê¸€</h3>
		<div class="popular-section">
			<div class="card-popular" th:each="post, iterStat : ${popularPosts}" th:if="${iterStat.index < 8}">
				<a th:href="@{'/AdoptDetail/{num}'(num=${post.boardNum})}" class="link-title">
					<strong th:text="${post.title}">ì œëª©</strong>
				</a>
				<!-- ì¸ê¸°ê¸€ ì¸ë„¤ì¼-->
				<a th:href="@{'/AdoptDetail/{num}'(num=${post.boardNum})}">
					<img class="thumb-image"
						th:src="@{${post.Image_paths != null} ? '/images/' + ${post.Image_paths} : '/imagesDefault/defaultBoard.png'}">
				</a>
				<span th:text="'ì‘ì„±ì: ' + ${post.nickName}">ì‘ì„±ì</span>
				<span th:text="'ì¢‹ì•„ìš”: ' + ${post.likes}">ì¢‹ì•„ìš”</span>
				<span th:text="'ëŒ“ê¸€ ìˆ˜: ' + ${post.commentCount}">ëŒ“ê¸€ ìˆ˜</span>
				<span th:text="'ì‘ì„±ì¼: ' + ${post.formattedRegistDate}">ì‘ì„±ì¼</span>
				<hr>
			</div>
		</div>

		<h3>ë³¸ë¬¸</h3>
		<!-- ì¹´ë“œí˜• ë³¸ë¬¸ (mainList ë°˜ë³µ) -->
		<div class="card-list-view">
			<div class="card-popular" th:each="board, iterStat : ${mainList}" th:if="${iterStat.index < 15}">
				<a th:href="@{'/AdoptDetail/{num}'(num=${board.boardNum})}" class="link-title">
					<strong th:text="${board.title}">ì œëª©</strong>
				</a>
				<a th:href="@{'/AdoptDetail/{num}'(num=${board.boardNum})}">
					<img class="thumb-image"
						th:src="@{${board.Image_paths != null} ? '/images/' + ${board.Image_paths} : '/imagesDefault/defaultBoard.png'}"
						alt="ì¸ë„¤ì¼" />
				</a>
				<span th:text="'ì‘ì„±ì: ' + ${board.nickName}">ì‘ì„±ì</span>
				<span th:text="'ë¶„ì–‘ê°€: ' + ${board.price}">ë¶„ì–‘ê°€</span>
				<span th:text="'ì¡°íšŒìˆ˜: ' + ${board.views}">ì¡°íšŒìˆ˜</span>
				<span th:text="'ëŒ“ê¸€ ìˆ˜: ' + ${board.commentCount}">ëŒ“ê¸€ ìˆ˜</span>
				<span th:text="'ì¢‹ì•„ìš”: ' + ${board.likes}">ì¢‹ì•„ìš”</span>
				<span th:text="'ì‘ì„±ì¼: ' + ${board.formattedRegistDate}">ì‘ì„±ì¼</span>
				<hr />
			</div>
			<div th:if="${mainList.size() == 0}">ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
		</div>


		<!-- ë¦¬ìŠ¤íŠ¸í˜• ë³¸ë¬¸ (ê¸°ì¡´ í…Œì´ë¸”) -->
		<table class="table-posts">
			<colgroup>
				<col style="width: 5%;" />
				<col style="width: 15%;" />
				<col style="width: 15%;" />
				<col style="width: 40%;" />
				<col style="width: 10%;" />
				<col style="width: 5%;" />
				<col style="width: 5%;" />
				<col style="width: 5%;" />
				<col style="width: 20%;" />
			</colgroup>
			<thead>
				<tr>
					<th>ë²ˆí˜¸</th>
					<th>ë¯¸ë¦¬ë³´ê¸°</th>
					<th>ì‘ì„±ì</th>
					<th>ì œëª©</th>
					<th>ë¶„ì–‘ê°€</th>
					<th>ì¡°íšŒìˆ˜</th>
					<th>ëŒ“ê¸€ ìˆ˜</th>
					<th>ì¢‹ì•„ìš”</th>
					<th>ì‘ì„±ì¼</th>
				</tr>
			</thead>
			
			<!-- ë³¸ë¬¸ ì½”ë“œ -->
			<tbody>
				<tr th:each="board, iterStat : ${mainList}" th:if="${iterStat.index < 15}">
					<td th:text="${board.boardNum}">1</td>
					<!-- ì¸ë„¬ ë³´ì´ê²Œ-->
					<td>
						<img class="thumb-image"
							th:src="@{${board.Image_paths != null} ? '/images/' + ${board.Image_paths} : '/imagesDefault/defaultBoard.png'}"
							alt="ì´ë¯¸ì§€" />
					</td>
					<td th:text="${board.nickName}"></td>
					<td>
						<a th:href="@{'/AdoptDetail/{num}'(num=${board.boardNum})}" class="link-title"
							th:text="${board.title + '(' + board.commentCount + ')'}">ì œëª©</a>
					</td>
					<td th:text="${board.price}"></td>
					<td th:text="${board.views}"></td>
					<td th:text="${board.commentCount}"></td>
					<td th:text="${board.likes}"></td>
					<td th:text="${board.formattedRegistDate}"></td>
				</tr>
				<tr th:if="${mainList.size() == 0}">
					<td colspan="9">ë“±ë¡ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
				</tr>
			</tbody>
		</table>
	</div>

	<!-- í˜ì´ì§€ ë„¤ì´ì…˜-->
	<div class="pagination">
		<ul class="pagination-list">
			<li class="pagination-item" th:if="${currentPage > 1}">
				<a class="pagination-link"
					th:href="@{/Adopt(page=${currentPage - 1}, keyword=${keyword}, field=${field})}">â—€ ì´ì „</a>
			</li>

			<li class="pagination-item" th:each="pageNum : ${#numbers.sequence(1, totalPages)}"
				th:classappend="${pageNum == currentPage} ? 'active'">
				<a class="pagination-link" th:href="@{/Adopt(page=${pageNum}, keyword=${keyword}, field=${field})}"
					th:text="${pageNum}">1</a>
			</li>

			<li class="pagination-item" th:if="${currentPage < totalPages}">
				<a class="pagination-link"
					th:href="@{/Adopt(page=${currentPage + 1}, keyword=${keyword}, field=${field})}">ë‹¤ìŒ â–¶</a>
			</li>
		</ul>
	</div>

	<script>
		// í˜ì´ì§€ ë¡œë“œ ì‹œ, URLì—ì„œ viewType íŒŒë¼ë¯¸í„° ì½ì–´ì„œ ë¼ë””ì˜¤ ì²´í¬ì™€ í™”ë©´ í‘œì‹œ ê²°ì •
		function getQueryParam(param) {
			const urlParams = new URLSearchParams(window.location.search);
			return urlParams.get(param);
		}

		function setViewType(viewType) {
			const cardView = document.querySelector('.card-list-view');
			const listView = document.querySelector('.table-posts');
			const radios = document.querySelectorAll('input[name="viewType"]');

			if (viewType === 'list') {
				cardView.classList.add('hidden');
				listView.classList.remove('hidden');
				radios.forEach(r => r.checked = (r.value === 'list'));
			} else {
				cardView.classList.remove('hidden');
				listView.classList.add('hidden');
				radios.forEach(r => r.checked = (r.value === 'card'));
			}
		}

		window.addEventListener('DOMContentLoaded', () => {
			let viewType = getQueryParam('viewType') || 'card';
			setViewType(viewType);

			// ë¼ë””ì˜¤ ë³€ê²½ ì‹œ, í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ë©´ì„œ viewType íŒŒë¼ë¯¸í„° ìœ ì§€
			document.querySelectorAll('input[name="viewType"]').forEach(radio => {
				radio.addEventListener('change', (e) => {
					const params = new URLSearchParams(window.location.search);
					params.set('viewType', e.target.value);
					// ë‹¤ë¥¸ ê²€ìƒ‰ íŒŒë¼ë¯¸í„° ìœ ì§€í•œ ì±„ë¡œ ìƒˆë¡œê³ ì¹¨
					window.location.search = params.toString();
				});
			});
		});
	</script>

</body>

</html>